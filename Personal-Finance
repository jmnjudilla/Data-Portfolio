SELECT * FROM personal_finance.personal_transactions;
SELECT DISTINCT(Category) FROM personal_finance.personal_transactions;
SELECT COUNT(DISTINCT(Category)) FROM personal_finance.personal_transactions;
SELECT DISTINCT(`Account Name`) FROM personal_finance.personal_transactions;
SELECT Date FROM personal_finance.personal_transactions;

--Total Expense
SELECT 
SUM(Amount) AS total_expense
FROM personal_finance.personal_transactions
WHERE `Transaction Type` = 'debit' OR Description = 'Credit Card Payment';

--Total Income
SELECT
SUM(Amount) AS total_income
FROM personal_finance.personal_transactions
WHERE Description = 'Biweekly Paycheck';

--Savings Rate (income-expenses)
SELECT
  SUM(
    CASE 
      WHEN `Transaction Type` = 'credit' AND Description != 'Credit Card Payment'
      THEN Amount
      ELSE 0
    END
  ) -
  SUM(
    CASE 
      WHEN `Transaction Type` = 'debit' 
        OR (`Transaction Type` = 'credit' AND Description = 'Credit Card Payment')
      THEN Amount
      ELSE 0
    END
  ) AS net_savings
FROM personal_finance.personal_transactions;

--Net Spending (expense - income)
SELECT
  SUM(
    CASE 
      WHEN `Transaction Type` = 'debit' 
        OR (`Transaction Type` = 'credit' AND Description = 'Credit Card Payment')
      THEN Amount
      ELSE 0
    END
  ) -
  SUM(
    CASE 
      WHEN `Transaction Type` = 'credit' AND Description != 'Credit Card Payment'
      THEN Amount
      ELSE 0
    END
  ) AS net_spending
FROM personal_finance.personal_transactions;

--Top 10 Largest Expenses
SELECT
amount
FROM personal_finance.personal_transactions
WHERE `Transaction Type` = 'debit' OR Description = 'Credit Card Payment'
ORDER BY 1 DESC
LIMIT 10;
